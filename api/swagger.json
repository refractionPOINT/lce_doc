{
  "openapi": "3.0.0",
  "x-explorer-enabled": true,
  "x-samples-enabled": true,
  "x-samples-languages": ["curl", "node", "ruby", "javascript", "python", "go"],
  "tags": [{
    "name": "Organizations",
    "description": "Operations related to the management of Organizations."
  },{
    "name": "Sensors",
    "description": "Operations related to the interaction with Sensors."
  },{
    "name": "Tags",
    "description": "Operations related to the tagging of sensors."
  },{
    "name": "Rules",
    "description": "Operations related to the Detection & Response rules."
  },{
    "name": "Outputs",
    "description": "Operations related to the forwarding of data."
  },{
    "name": "General",
    "description": "Misc. Operations."
  },{
    "name": "Retention",
    "description": "Operations related to data retention, visualization and searching."
  },{
    "name": "Service",
    "description": "Operations related to interaction with LimaCharlie Services."
  },{
    "name": "Users",
    "description": "Operations related to user and permissions management."
  },{
    "name": "Resources",
    "description": "Operations related to subscription and updating of Resources."
  },{
    "name": "Payload",
    "description": "Operations related to the management of Payloads."
  },{
    "name": "Jobs",
    "description": "Operations related to the management of Jobs."
  },{
    "name": "Exports",
    "description": "Operations related to the exporting of data."
  },{
    "name": "False Positives",
    "description": "Operations related to the management of False Positive rules."
  },{
    "name": "Installation Keys",
    "description": "Operations related to the management of Installation Keys."
  },{
    "name": "Artifacts",
    "description": "Operations related to the management of Artifacts."
  },{
    "name": "Api Keys",
    "description": "Operations related to the management of API Keys."
  },{
    "name": "Modules",
    "description": "Operations related to the management of sensor versions deployed."
  },{
    "name": "Audit",
    "description": "Operations related to the Audit logs."
  },{
    "name": "Errors",
    "description": "Operations related to the Error logs."
  },{
    "name": "Billing",
    "description": "Operations related to the management of Billing."
  }],
  "info": {
    "termsOfService": "https://limacharlie.io/tos",
    "contact": {
      "email": "info@limacharlie.io"
    },
    "description": "This is the REST API for LimaCharlie.io",
    "license": {
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html",
      "name": "Apache 2.0"
    },
    "title": "LimaCharlie.io REST API",
    "version": "1.0.0"
  },
  "paths": {
    "/orgs/{oid}": {
      "get": {
        "operationId": "getOrgInfo",
        "tags": [
          "Organizations"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get information about the organization."
      }
    },
    "/orgs/{oid}/url": {
      "get": {
        "operationId": "getOrgURLs",
        "tags": [
          "Organizations"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the various access URLs used by resources related to the organization."
      }
    },
    "/sensors/{oid}": {
      "get": {
        "operationId": "getSensorList",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the list of sensors belonging to the organization."
      }
    },
    "/online/{oid}": {
      "get": {
        "operationId": "getOnlineSensors",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the number of sensors online belonging to the organization."
      },
      "post": {
        "operationId": "getOnlineSensorsInList",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sids",
            "description": "list of sensor id to check online status for",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the online status of multiple sensors."
      }
    },
    "/{sid}": {
      "get": {
        "operationId": "getSensorInfo",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the sensor information and online status."
      },
      "post": {
        "operationId": "taskSensor",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "tasks",
            "description": "list of tasks to send",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "in": "query"
          },
          {
            "name": "investigation_id",
            "description": "a tag included in data returned from sensor resulting from the tasks",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Send a task to a sensor."
      },
      "delete": {
        "operationId": "deleteSensor",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Delete a sensor."
      }
    },
    "/{sid}/tags": {
      "get": {
        "operationId": "getSensorTags",
        "tags": [
          "Sensors",
          "Tags"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the sensor tags."
      },
      "post": {
        "operationId": "addSensorTag",
        "tags": [
          "Sensors",
          "Tags"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "tags",
            "description": "list of tags to add",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "in": "query"
          },
          {
            "name": "ttl",
            "description": "number of seconds the tag is valid for",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Add tags to the sensor."
      },
      "delete": {
        "operationId": "removeSensorTag",
        "tags": [
          "Sensors",
          "Tags"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "tag",
            "description": "tag to delete",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "tags",
            "description": "tags to delete, as a comma separated list",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Remove a tag from the sensor."
      }
    },
    "/{sid}/isolation": {
      "get": {
        "operationId": "getSensorIsolation",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the sensor isolation status."
      },
      "post": {
        "operationId": "isolateSensor",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Set the sensor in network isolation."
      },
      "delete": {
        "operationId": "rejoinSensor",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Remove the sensor from network isolation."
      }
    },
    "/hostnames/{oid}": {
      "get": {
        "operationId": "findSensorByHostname",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "hostname",
            "description": "hostname prefix to search for",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get sensors with hostnames matching given expression."
      }
    },
    "/ips/{oid}": {
      "get": {
        "operationId": "findSensorWithIP",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "ip",
            "description": "ip to search for",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "start",
            "description": "unix epoch when time range begins",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "unix epoch when time range ends",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get sensors using matching external or internal IP for a time range."
      }
    },
    "/tasks": {
      "get": {
        "operationId": "getAvailableSensorTasks",
        "tags": [
          "Sensors"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the usage information for commands that can be sent to sensors."
      }
    },
    "/tasks/{cmd}": {
      "get": {
        "operationId": "getTaskUsage",
        "tags": [
          "Sensors"
        ],
        "parameters": [
          {
            "name": "cmd",
            "description": "name of the command get the help from, optional",
            "schema": {
              "type": "string"
            },
            "in": "path",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the usage information for commands that can be sent to sensors."
      }
    },
    "/tags/{oid}/{tag_expr}": {
      "get": {
        "operationId": "findSensorsWithTag",
        "tags": [
          "Sensors",
          "tags"
        ],
        "parameters": [
          {
            "name": "tag_expr",
            "in": "path",
            "required": true,
            "description": "tag search expression (% wilcard)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Search for tags matching a search expression and belonging to the organization."
      }
    },
    "/rules/{oid}": {
      "get": {
        "operationId": "getOrgRules",
        "tags": [
          "Rules"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "namespace",
            "description": "specific namespace to operate on, defaults to 'general'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "List all active detection for a specific organization."
      },
      "post": {
        "operationId": "setOrgRule",
        "tags": [
          "Rules"
        ],
        "parameters": [
          {
            "name": "name",
            "description": "unique name of the new rule",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "detection",
            "description": "detection expression of the new rule",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "response",
            "description": "response expression of the new rule",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_replace",
            "description": "if the rule with this name exists, replace it, 'true' or 'false'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_enabled",
            "description": "if the rule should be enabled, 'true' or 'false'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "namespace",
            "description": "specific namespace to operate on, defaults to 'general'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Add a new detection and response rule to the organization."
      },
      "delete": {
        "operationId": "removeOrgRule",
        "tags": [
          "Rules"
        ],
        "parameters": [
          {
            "name": "name",
            "description": "unique name of the rule to delete",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "namespace",
            "description": "specific namespace to operate on, defaults to 'general'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Delete a detection and response rule from an organization."
      }
    },
    "/fp/{oid}": {
      "get": {
        "operationId": "getOrgFalsePositiveRule",
        "tags": [
          "False Positives"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "List all active false positive rules for a specific organization."
      },
      "post": {
        "operationId": "setOrgFalsePositiveRule",
        "tags": [
          "False Positives"
        ],
        "parameters": [
          {
            "name": "name",
            "description": "unique name of the new rule",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "rule",
            "description": "expression of the new rule",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_replace",
            "description": "if the rule with this name exists, replace it, 'true' or 'false'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Add a new false positive rule to the organization."
      },
      "delete": {
        "operationId": "removeOrgFalsePositiveRule",
        "tags": [
          "False Positives"
        ],
        "parameters": [
          {
            "name": "name",
            "description": "unique name of the rule to delete",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Delete a false positive rule from an organization."
      }
    },
    "/modules/{oid}": {
      "post": {
        "operationId": "upgradeOrg",
        "tags": [
          "Modules"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "is_fallback",
            "description": "if set to true downgrade to the previous version of the sensor, 'true' or 'false'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Update the sensor version and regenerate installation keys for the organization."
      }
    },
    "/installationkeys/{oid}": {
      "get": {
        "operationId": "getInstallationKeys",
        "tags": [
          "Installation Keys"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the installation keys for the organization."
      },
      "post": {
        "operationId": "addInstallationKey",
        "tags": [
          "Installation Keys"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "tags",
            "description": "tags to associate with sensors",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "in": "query"
          },
          {
            "name": "desc",
            "description": "description of key",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Create a new installation key for the organization."
      },
      "delete": {
        "operationId": "removeInstallationKey",
        "tags": [
          "Installation Keys"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "iid",
            "description": "installer id to delete",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Delete an installation key for the organization."
      }
    },
    "/outputs/{oid}": {
      "get": {
        "operationId": "getOutputs",
        "tags": [
          "Outputs"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the various outputs for an organization."
      },
      "post": {
        "operationId": "setOutput",
        "tags": [
          "Outputs"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "module",
            "description": "output module name to enable",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "type",
            "description": "data type for output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "name",
            "description": "what to name this output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "inv_id",
            "description": "if specified, only events part of this investigation id will be sent to this output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "tag",
            "description": "if specified, only events coming from sensors with the specific tag will be sent to this output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "cat",
            "description": "if specified, only detections in this category will be sent to this output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_flat",
            "description": "if the json should be flattened (true, false)",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "dir",
            "description": "directory for output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "max_bytes",
            "description": "max size in bytes before rotation",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "backup_count",
            "description": "maximum number of output in rotation",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "bucket",
            "description": "name of the bucket for output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "key_id",
            "description": "public key id for auth",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "secret_key",
            "description": "secret key for auth",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "sec_per_file",
            "description": "seconds per output files",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "dest_host",
            "description": "destination host for output",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "username",
            "description": "username for auth",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "password",
            "description": "password for auth",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "slack_api_token",
            "description": "slack api token for auth",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "slack_channel",
            "description": "slack channel to output to",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_tls",
            "description": "whether connection should be secured over tls (true, false)",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_no_header",
            "description": "whether protocol header should be sent before the data (true, false)",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_delete_on_failure",
            "description": "if enabled, the output will be deleted as soon as a connection error occurs (true, false)",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "structured_data",
            "description": "if included, will insert a Structured Data field into the Syslog header (as per RFC) with this static value",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "humio_repo",
            "description": "the humio.com repository to send the data to",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "humio_api_token",
            "description": "the humio.com secret token to send data with",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "event_white_list",
            "description": "whitelist of event types to allow",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "event_black_list",
            "description": "blacklist of event types to disallow",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "cat_black_list",
            "description": "blacklist of categories to disallow",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "routing_topic",
            "description": "topic to publish on from the routing of then event",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "literal_topic",
            "description": "literal topic to publish on",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Enable a specific output module for an organization."
      },
      "delete": {
        "operationId": "removeOutput",
        "tags": [
          "Outputs"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "description": "output module name to disable",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Disable a specific output module for an organization."
      }
    },
    "/outputs/{oid}/samples": {
      "get": {
        "operationId": "getOutputSamples",
        "tags": [
          "Outputs"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "description": "output module name to get samples from",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get sample data from an Output."
      }
    },
    "/audit/{oid}": {
      "get": {
        "operationId": "getAuditLog",
        "tags": [
          "Audit"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the audit log for the organization."
      }
    },
    "/errors/{oid}": {
      "get": {
        "operationId": "getErrorLog",
        "tags": [
          "Errors"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the error log for the organization."
      }
    },
    "/autocomplete/task": {
      "get": {
        "operationId": "autocompleteTask",
        "tags": [
          "Sensors"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get autocomplete information for sensor tasking."
      }
    },
    "/events": {
      "get": {
        "operationId": "getAvailableEvents",
        "tags": [
          "General"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get available event names."
      }
    },
    "/insight/{oid}": {
      "get": {
        "operationId": "getInsightStatus",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Check if the organization is configured with Insight."
      }
    },
    "/insight/{oid}/{sid}": {
      "get": {
        "operationId": "getHistoricEvents",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin fetching events",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop fetching events",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "limit",
            "description": "maximum number of events to return",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "event_type",
            "description": "specific event type to fetch",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_compressed",
            "description": "set to 'true' to enable compression, data returned 'events' is base64(gzip(data))",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "cursor",
            "description": "optional cursor for paginated access, set to '-' for first query",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_forward",
            "description": "direction of paginated query results, defaults to 'true' (ascending).",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve historical data from the sensor using Insight."
      }
    },
    "/insight/{oid}/{sid}/overview": {
      "get": {
        "operationId": "getHistoricEventOverview",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sid",
            "in": "path",
            "required": true,
            "description": "sensor id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin fetching events",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop fetching events",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve overview data of the historical data from the sensor using Insight."
      }
    },
    "/insight/{oid}/detections": {
      "get": {
        "operationId": "getDetections",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin fetching detections",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop fetching detections",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "limit",
            "description": "maximum number of detections to return",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "cat",
            "description": "specific detection category to fetch",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_compressed",
            "description": "set to 'true' to enable compression, data returned 'detects' is base64(gzip(data))",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "cursor",
            "description": "optional cursor for paginated access, set to '-' for first query",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve historical detections using Insight."
      },
      "delete": {
        "operationId": "deleteAllDetections",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Delete all detections stored in Insight."
      }
    },
    "/insight/{oid}/objects/{objType}": {
      "get": {
        "operationId": "getObjectInformation",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "objType",
            "in": "path",
            "required": true,
            "description": "type of object, one of: user, domain, ip, file_hash, file_path, file_name, service_name, package_name",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "description": "name of the object to look for",
            "required": true,
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "info",
            "description": "the type of information to receive, one of: summary, locations",
            "required": true,
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "case_sensitive",
            "description": "set to 'false' to disable case sensitivity",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "with_wildcards",
            "description": "set to 'true' to be able to use '%' wildcards in the object name",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve historical information about specific objects / indicators using Insight."
      }
    },
    "/insight/{oid}/objects": {
      "get": {
        "operationId": "getSpecificObjects",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "objects",
            "description": "a JSON dictionary like: {objType: [objName1, objName2, ...]}",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "case_sensitive",
            "description": "set to 'false' to disable case sensitivity",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve historical information about specific objects / indicators using Insight."
      }
    },
    "/insight/{oid}/objects_timeline": {
      "post": {
        "operationId": "getObjectTimeline",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "objects",
            "description": "a JSON dictionary like: {objType: [objName1, objName2, ...]}",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "case_sensitive",
            "description": "set to 'false' to disable case sensitivity",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_compressed",
            "description": "set to 'true' to enable compression, data returned 'events' is base64(gzip(data))",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "sid",
            "description": "if specified, use all data from the sensor id instead of from specific objects",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "bucketing",
            "description": "bucket size of object prevalence, one of hour, day, week, month",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve a timeline of usage about specific objects / indicators using Insight."
      }
    },
    "/insight/{oid}/object_usage/{objType}": {
      "post": {
        "operationId": "getObjectSummary",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "objType",
            "in": "path",
            "required": true,
            "description": "type of object, one of: user, domain, ip, file_hash, file_path, file_name, service_name, package_name",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "description": "name of the object to look for",
            "required": true,
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "case_sensitive",
            "description": "set to 'false' to disable case sensitivity",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_compressed",
            "description": "set to 'true' to enable compression, data returned 'events' is base64(gzip(data))",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve summarized usage for a specific object / indicator using Insight."
      }
    },
    "/insight/{oid}/traffic/breakdown": {
      "get": {
        "operationId": "getTrafficBreakdown",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve traffic type information using Insight."
      }
    },
    "/insight/{oid}/traffic/stats": {
      "get": {
        "operationId": "getTrafficStats",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve traffic stats information using Insight."
      }
    },
    "/insight/{oid}/detections/stats": {
      "get": {
        "operationId": "getDetectionStats",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve detection stats information using Insight."
      }
    },
    "/insight/{oid}/detections/breakdown": {
      "get": {
        "operationId": "getDetectionBreakdown",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve detection type information using Insight."
      }
    },
    "/insight/{oid}/online/stats": {
      "get": {
        "operationId": "getOnlineStats",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve stats on sensors online using Insight."
      }
    },
    "/insight/{oid}/ingestion_keys": {
      "get": {
        "operationId": "getIngestionKeys",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the ingestion keys."
      },
      "post": {
        "operationId": "addIngestionKey",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "description": "name of the ingestion key to create",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Create a new ingestion key."
      },
      "delete": {
        "operationId": "removeIngestionKey",
        "tags": [
          "Retention"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "description": "name of the ingestion key to remove",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Remove an ingestion key."
      }
    },
    "/insight/{oid}/artifacts": {
      "get": {
        "operationId": "getArtifactList",
        "tags": [
          "Retention",
          "Artifacts"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "cursor",
            "description": "optional cursor for paginated access, set to '-' for first query",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the list of logs available during a time frame."
      }
    },
    "/insight/{oid}/artifacts/payloads/{payload_id}": {
      "get": {
        "operationId": "getArtifactInfo",
        "tags": [
          "Retention",
          "Artifacts"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "payload_id",
            "in": "path",
            "required": true,
            "description": "payload/log id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "records",
            "description": "the record IDs to retrieve specifically, repeated field",
            "schema": {
              "type": "array",
              "items": {
                "type": "integer"
              }
            },
            "in": "query"
          },
          {
            "name": "is_compressed",
            "description": "set to 'true' to enable compression, data returned 'logs' is base64(gzip(data))",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve the parsed/readable version of a specific log."
      }
    },
    "/insight/{oid}/artifacts/originals/{payload_id}": {
      "get": {
        "operationId": "getOriginalArtifact",
        "tags": [
          "Retention",
          "Artifacts"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "payload_id",
            "in": "path",
            "required": true,
            "description": "payload/log id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve the original version of a specific log."
      }
    },
    "/usage/{oid}": {
      "get": {
        "operationId": "getOrgUsageStats",
        "tags": [
          "Organizations"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get various organization usage stats."
      }
    },
    "/service/{oid}/{service_name}": {
      "post": {
        "operationId": "makeServiceRequest",
        "tags": [
          "Service"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "service_name",
            "in": "path",
            "required": true,
            "description": "Service name to send the request to",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "request_data",
            "description": "request data, as a base64 encoded string containing the JSON request",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_async",
            "description": "if set to 'true', this REST call will not wait for the Service to finish handling the request",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Send a request to a Service."
      }
    },
    "/service/{oid}": {
      "get": {
        "operationId": "getAvailableServices",
        "tags": [
          "Service"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the list of Services enabled on this organization."
      }
    },
    "/service/{service_name}/usage": {
      "get": {
        "operationId": "getServiceUsage",
        "tags": [
          "Service"
        ],
        "parameters": [
          {
            "name": "service_name",
            "in": "path",
            "required": true,
            "description": "Service name to send the request to",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the usage parameters for requests to the service."
      }
    },
    "/orgs/{oid}/users": {
      "get": {
        "operationId": "getOrgUsers",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "List all users in organization."
      },
      "post": {
        "operationId": "addOrgUser",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "name": "email",
            "description": "email of the user to add",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Add a new user to the organization."
      },
      "delete": {
        "operationId": "removeOrgUser",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "name": "email",
            "description": "email of the user to remove",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Remove a user from an organization."
      }
    },
    "/orgs/{oid}/keys": {
      "get": {
        "operationId": "getOrgApiKeys",
        "tags": [
          "Api Keys"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "List API keys in organization."
      },
      "post": {
        "operationId": "addOrgApiKey",
        "tags": [
          "Api Keys"
        ],
        "parameters": [
          {
            "name": "key_name",
            "description": "name of the key to add",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "perms",
            "description": "comma separated values of the permissions of the key to add",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Add a new user to the organization."
      },
      "delete": {
        "operationId": "removeOrgApiKey",
        "tags": [
          "Api Keys"
        ],
        "parameters": [
          {
            "name": "key_hash",
            "description": "hash of the key to remove",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Remove an API key from an organization."
      }
    },
    "/orgs/{oid}/users/permissions": {
      "get": {
        "operationId": "getUsersAndPermissions",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "List all users and permissions in organization."
      },
      "post": {
        "operationId": "addUserPermission",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "name": "email",
            "description": "email of the user to add a permission to",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "perm",
            "description": "permission to give",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Add a new user to the organization."
      },
      "delete": {
        "operationId": "removeUserPermission",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "name": "email",
            "description": "email of the user to remove the permission from",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "perm",
            "description": "permission to remove",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Remove a user permission."
      }
    },
    "/orgs/{oid}/resources": {
      "get": {
        "operationId": "getOrgResources",
        "tags": [
          "Resources"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "List all resources subscribed to by an organization."
      },
      "post": {
        "operationId": "registerOrgToResource",
        "tags": [
          "Resources"
        ],
        "parameters": [
          {
            "name": "res_cat",
            "description": "resource category of the resource to subscribe to, like 'lookup'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "res_name",
            "description": "resource name of the resource to subscribe to",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Subscribe the organization to a resource."
      },
      "delete": {
        "operationId": "unregisterOrgFromResource",
        "tags": [
          "Resources"
        ],
        "parameters": [
          {
            "name": "res_cat",
            "description": "resource category of the resource to unsubscribe from, like 'lookup'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "res_name",
            "description": "resource name of the resource to unsubscribe from",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Unsubscribe an organization from a resource."
      }
    },
    "/orgs/{oid}/quota": {
      "post": {
        "operationId": "setOrgQuota",
        "tags": [
          "Billing"
        ],
        "parameters": [
          {
            "name": "quota",
            "description": "new sensor quota to request for organization",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Request a new sensor quota for an organization."
      }
    },
    "/payload/{oid}/{payloadName}": {
      "get": {
        "operationId": "getPayload",
        "tags": [
          "Payload"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "payloadName",
            "in": "path",
            "required": true,
            "description": "payload name",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the content of a payload."
      },
      "post": {
        "operationId": "addPayload",
        "tags": [
          "Payload"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "payloadName",
            "in": "path",
            "required": true,
            "description": "payload name",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Create a new payload."
      },
      "delete": {
        "operationId": "removePayload",
        "tags": [
          "Payload"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "payloadName",
            "in": "path",
            "required": true,
            "description": "payload name",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Remove an existing payload."
      }
    },
    "/payload/{oid}": {
      "get": {
        "operationId": "listPayloads",
        "tags": [
          "Payload"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Get the list of existing payloads."
      }
    },
    "/job/{oid}": {
      "get": {
        "operationId": "getJobs",
        "tags": [
          "Jobs"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "start",
            "description": "required timestamp in seconds where to begin fetching jobs",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "end",
            "description": "required timestamp in seconds where to stop fetching jobs",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "limit",
            "description": "maximum number of jobs to return",
            "schema": {
              "type": "integer"
            },
            "in": "query"
          },
          {
            "name": "sid",
            "description": "optionally only fetch jobs relating to a Sensor ID",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "is_compressed",
            "description": "set to 'true' to enable compression, data returned is base64(gzip(data))",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "with_data",
            "description": "optionally include full job data, 'true' or 'false'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Retrieve jobs for an organization."
      }
    },
    "/job/{oid}/{job_id}": {
      "get": {
        "operationId": "getJobInfo",
        "tags": [
          "Jobs"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "description": "job id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "is_compressed",
            "description": "set to 'true' to enable compression, data returned is base64(gzip(data))",
            "schema": {
              "type": "string"
            },
            "in": "query"
          },
          {
            "name": "with_data",
            "description": "optionally include full job data, 'true' or 'false'",
            "schema": {
              "type": "string"
            },
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Fetch a specific job."
      },
      "delete": {
        "operationId": "removeJob",
        "tags": [
          "Jobs"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "description": "job id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Delete a specific job."
      }
    },
    "/export/{oid}/sensors": {
      "post": {
        "operationId": "exportSensorList",
        "tags": [
          "Exports",
          "Sensors"
        ],
        "parameters": [
          {
            "name": "oid",
            "in": "path",
            "required": true,
            "description": "organization id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "successful operation"
          },
          "401": {
            "description": "Access token is missing or invalid"
          }
        },
        "description": "Export the full sensor list (info and tags) for the Organization."
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "servers": [
    {
      "url": "https://api.limacharlie.io/v1"
    }
  ]
}