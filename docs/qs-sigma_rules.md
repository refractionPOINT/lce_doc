# Using the Sigma Rule Set

Endpoint Detection & Response (EDR) uses rules to discover and take action against malicious behaviour. LimaCharlie uses its own YAML-based language to express Detection & Response (DR) rules and can also leverage existing community-based formats such as YARA and Sigma.

The focus of this lesson is to get the user setup with [basic Sigma rule](https://github.com/refractionPOINT/rules/tree/master/Sigma) coverage across all endpoints. To do so we are going to deploy a mirror of the official Sigma rule. Later in the lesson we will show you how to create False Positive rules.

The Sigma rule set is an open source signature format that can describe relevant log events in a straightforward manner. The rule format itself is very flexible and applicable to any type of log file. The main purpose of Sigma is to provide a structured form with which researchers and analysts can describe and share detection methods with the wider community.

More information on Sigma: Generic Signature Format for SIEM Systems.

## Endpoint Detection & Response

Endpoint Detection & Response (EDR) uses rules to discover and take action against malicious behaviour. LimaCharlie uses a YAML-based language to express Detection & Response (DR) rules and can leverage existing community-based formats such as YARA and Sigma.

In this lesson we are going to deploy a mirror of the official Sigma rule set which will enable solid coverage across the entire fleet. Later in the lesson we will show you how to create False Positive rules.

The Sigma rule set is an open source signature format that can describe relevant log events in a straightforward manner. The rule format itself is very flexible and applicable to any type of log file. The main purpose of Sigma is to provide a structured form with which researchers and analysts can describe and share detection methods with the wider community.

More information on Sigma: [Generic Signature Format for SIEM Systems](https://github.com/Neo23x0/sigma)

Details on LimaCharlie's own powerful Detection & Response language can be found [here]().

## Getting Started

Getting started with Sigma detection coverage is easy. In the web application, navigate to the Setup section of the main navigation and click on Add-ons.

From the Services tab scroll down until you find the Sigma add-on and turn it on.

The Sigma rules are immediately applied to telemetry coming in from the sensors. Some Sigma rules on Windows rely on Windows Event Logs which are not collected by LimaCharlie by default. In order to leverage these you will need to configure [automated collection of relevant Windows Event Logs](./external_logs.md#windows-event-logs) through the [Artifact Collection service](./external_logs.md#artifact-collection).

## False Positives

A false positive error, or false positive, is a result that indicates a given condition existing when it does not. When applied to DR rules this means an event (as generated by the report action), or series of events, taking place on the endpoint has triggered a detection from expected behaviour. Depending on the conditions around which the detection was fired the operator may choose to create a false positive rule which will mark the offending conditions as an exception.

### Use Cases

The typical use case for FP rules is to add exceptions from some detections that are cross-cutting (for example ignore all detections from a specific host), organization-specific exceptions (like ignoring alerts relating to a custom piece of software used in an organization), or suppressing errors from managed D&R rules you don't have direct access to.

### Structure

An FP rule is structured with the same format at the detection component of a D&R rule. The main difference is that the rule applies to the content of a detection, as can be seen in the Detections section of the web app.

Most stateless operators from the D&R rules are available in FP rules.

**Examples**

*Prevent a specific detection*:

```yaml
op: is
path: cat
value: my-detect-name
```

*Ignore any detection that relates to a file name in any path*:

```yaml
op: ends with
path: detect/event/FILE_PATH
value: this_is_fine.exe
```

*Any detection originating from a specific host will be ignored*:

```yaml
op: is
path: routing/hostname
value: web-server-2
```